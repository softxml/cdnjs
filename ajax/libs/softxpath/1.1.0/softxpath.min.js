function SoftXpath(){function l(a){for(var b=0;b<reservedXpathKeywords.length;b++)if(String(reservedXpathKeywords[b])==a)return!0;return!1}var a="undefined"!=typeof document.implementation&&"undefined"!=typeof document.implementation.createDocument,b=!1,c=a||b?document.implementation.createDocument("","doc",null):new ActiveXObject("MSXML2.DOMDocument.3.0"),d=navigator.userAgent.toLowerCase().indexOf("chrome")>-1,e=navigator.userAgent.toLowerCase().indexOf("safari")>-1,f=navigator.userAgent.toLowerCase().indexOf("k-meleon")>-1,h="",i="",j=/\//gi,k=/\/\//i;reservedXpathKeywords=["ancestor","ancestor-or-self","attribute","child","descendant","descendant-or-self","following","following-sibling","namespace","parent","preceding","preceding-sibling","self"],this.registerNamespace=function(a,b){h=a,i=b},this.load=function(a){var g=!1;if(c.async=!1,b)try{c=ls.parseURI(a),g="parsererror"==c.documentElement.nodeName?!1:!0}catch(h){g=!1}else if(d||e||f){var i=new XMLHttpRequest;i.open("GET",a,!1),i.send(null);try{return c=i.responseXML.documentElement,!0}catch(h){return!1}}else try{g=c.load(a)}catch(h){return!1}return g},this.loadXML=function(d){var e=!1;if(a||b){var f=new DOMParser;c=f.parseFromString(d,"text/xml"),e="parsererror"==c.documentElement.nodeName?!1:!0}else e=c.loadXML(d);return e},this.selectNodes=function(b){var d="",e="",f=new Array,g=b.match(k);if(""!=h){for(var m=String(b).split(j),n=0;n<m.length;n++)"@"!=m[n].substring(0,1)?m[n]>""&&(d+=n>0&&!l(String(m[n-1]).split("::")[1])?"undefined"!=typeof String(m[n]).split("::")[1]?String(m[n]).split("::")[0]+"::"+h+":"+String(m[n]).split("::")[1]+"/":h+":"+m[n]+"/":h+":"+m[n]+"/"):d+=m[n]+"/";d=d.substring(0,d.length-1)}else d=b;if(null!=g&&(e=""!=h?g+d:d),a){var o=new XMLSerializer,p=new XPathEvaluator,q=(new XPathEvaluator).createNSResolver(null==c.ownerDocument?c.documentElement:c.ownerDocument.documentElement);try{var r=b>""?p.evaluate(e,c,q,0,null):"0"}catch(s){return f}if("0"!=r)for(;res=r.iterateNext();){try{xmstr=o.serializeToString(res)}catch(s){xmstr=""}f[f.length]={nodeName:res.nodeName,text:res.textContent,me:{_:res,xml:xmstr}}}}else try{try{c.setProperty("SelectionNamespaces","xmlns:"+h+"='"+i+"'"),c.setProperty("SelectionLanguage","XPath")}catch(s){}for(nodes=c.selectNodes(e),n=0;n<nodes.length;n++)f[n]={nodeName:nodes[n].nodeName,text:nodes[n].childNodes[0].nodeValue,me:{_:nodes[n],xml:nodes[n].xml}}}catch(s){}return f}}
